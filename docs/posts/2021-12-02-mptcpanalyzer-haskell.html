<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Software ninja - Analyze mptcp packet captures with mptcpanalyzer</title>
        <link rel="stylesheet" href="../css/default.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Ninja hacking</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Analyze mptcp packet captures with mptcpanalyzer</h1>
            <article>
    <section class="header">
    Posted on December  2, 2021
    
        by Matt
    
    </section>
    <section>
    
    Tags: <a title="All pages tagged 'mptcp'." href="../tags/mptcp.html">mptcp</a>, <a title="All pages tagged 'mptcpanalyzer'." href="../tags/mptcpanalyzer.html">mptcpanalyzer</a>
    
    </section>
    <section>
<p>See <a href="./2021-12-02-install-mptcp-kernel.markdown">my other post</a> for an introduction of MPTCP. Even though it is an extension of TCP, the changes are deep enough that it could be considered a new protocol. <a href="posts/2021-12-02-install-mptcp-kernel.markdown">How to install MPTCP on linux</a></p>
<p>Follow <a href="https://github.com/teto/mptcpanalyzer/tree/main/mptcpanalyzer#installation">mptcpanalyzerâ€™s README</a> instructions to install the software.</p>
<p>First we need some pcaps, you can either <a href="posts/2021-12-02-generate-mptcp-traces.markdown">capture some traffic yourself</a>, or download some PCAPs from either the <a href="https://wiki.wireshark.org/SampleCaptures#MPTCP">wireshark wiki</a> or <a href="https://github.com/teto/mptcpanalyzer/tree/main/mptcpanalyzer/examples">mptcpanalyzer examples</a>.</p>
<p>Start <code>mptcpanalyzer</code> then load the pcap with:</p>
<pre><code>load-pcap examples/client_2_filtered.pcapng</code></pre>
<p><code>help</code> shows you the available commands.</p>
<p>To inspect at high level the pcap, run:</p>
<pre><code>list-tcp</code></pre>
<p>to list tcp connections.</p>
<p>Similarly you can list mptcp-sessions:</p>
<pre><code>examples/client_2_filtered.pcapng&gt; list-mptcp
Number of MPTCP connections 2
[StreamId 0,StreamId 1]
Server key/token: 10048458395084872514/2846245513
Client key/token: 17227928701987094984/4093186044

Subflows:
10.0.0.1:33782 -&gt; 10.0.0.2:5201 (tcp.stream: 0)
10.0.0.1:54595 -&gt; 11.0.0.2:5201 (tcp.stream: 2)
11.0.0.1:35589 -&gt; 10.0.0.2:5201 (tcp.stream: 6)
11.0.0.1:59555 -&gt; 11.0.0.2:5201 (tcp.stream: 4)

Server key/token: 14803550490012999960/1015310287
Client key/token: 2708191410426849018/3188734930

Subflows:
10.0.0.1:33784 -&gt; 10.0.0.2:5201 (tcp.stream: 1)
10.0.0.1:57491 -&gt; 11.0.0.2:5201 (tcp.stream: 3)
11.0.0.1:50007 -&gt; 10.0.0.2:5201 (tcp.stream: 7)
11.0.0.1:50077 -&gt; 11.0.0.2:5201 (tcp.stream: 5)</code></pre>
<p>To examine deeper a communication:</p>
<pre><code>examples/client_2_filtered.pcapng&gt; mptcp-summary --full 0
[info]  [Main#657] Running [&quot;mptcp-summary&quot;,&quot;--full&quot;,&quot;0&quot;]
Server key/token: 10048458395084872514/2846245513
Client key/token: 17227928701987094984/4093186044

Subflows:
10.0.0.1:33782 -&gt; 10.0.0.2:5201 (tcp.stream: 0)
10.0.0.1:54595 -&gt; 11.0.0.2:5201 (tcp.stream: 2)
11.0.0.1:35589 -&gt; 10.0.0.2:5201 (tcp.stream: 6)
11.0.0.1:59555 -&gt; 11.0.0.2:5201 (tcp.stream: 4)

[debug] [M.C.List#286] Number of rows 4164
 Mptcp stats towards RoleClient :
- Duration (50.869754285s,Timestamp 0.0,Timestamp 50.869754285)
- Goodput 3.1649455017610375
&lt;TODO&gt;

Applicative Bytes : 161
Subflow stats:
stream StreamId 0: transferred 308.0 out of 161 between 5.211195538 end time: 50.869754285 , accouting for 1.9130434782608696 %
stream StreamId 2: transferred 0.0 out of 161 between 6.235584666 end time: 50.803757013 , accouting for 0.0 %
stream StreamId 6: transferred 0.0 out of 161 between 7.943047833 end time: 45.887953648999996 , accouting for 0.0 %
stream StreamId 4: transferred 4.294967295e9 out of 161 between 0.0 end time: 0.0 , accouting for 2.667681549689441e7 %</code></pre>
    </section>
</article>

        </main>

        <footer>
            Site generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
