<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Software ninja - Working with the MPTCP path manager</title>
        <link rel="stylesheet" href="../css/default.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Ninja hacking</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Working with the MPTCP path manager</h1>
            <article>
    <section class="header">
    Posted on December  2, 2021
    
        by Matt
    
    </section>
    <section>
    
    Tags: 
    
    </section>
    <section>
<p>Multipath TCP (mptcp) is an extension of TCP (Transmission Control Protocol) to transfer data over multiple paths.</p>
<p>On linux, MPTCP is implemented in kernel space. Working in kernelspace brings some constraints (program in C, no libc etc). Most programs are easier being developed in userspace where segfaults won’t bring your OS down. Gladly, there is protocol called “netlink” to exchange data between userspace and kernelspace. netlink is a TLV (type-length-value) protocol with different protocols built on top of it such as this MPTCP path management protocol.</p>
<p>These protocols are adhoc and usually not documented (apart from the source code). That’s where [wireshark][wireshark] comes in handy.</p>
<p>This capacity is leveraged by the <a href="http://mutipath-tcp.org">out-of-tree</a> linux MPTCP path manager.</p>
<p>You can install our plugin which appears in mptcp-pm contrib folder: 1. Download <a href="github.com/teto/mptcpanalyzer/contrib/mptcp.lua">mptcp plugin</a>. 2. Move it to ~/.config/wireshark/plugins</p>
<p>To test it is properl installed you can: 1. Download from the same repo an <a href="github.com/teto/mptcpanalyzer/mptcp-pm/contrib/netlink-mptcp.pcapng">example pcap</a>. 2. Load it in wireshark 3. Then you can filter for <code>genl.mptcp.cmd</code></p>
<p>Even more interesting is the ability to diagnose these events live.</p>
<p>To achive this run:</p>
<pre><code>sudo ip link add nlmon0 type nlmon
sudo ip link set dev nlmon0 up</code></pre>
<p>a new interface “nlmon0” should appear in wireshark you can monitor from !</p>
<p>Cheers.</p>
<p>wireshark: www.wireshark.org</p>
    </section>
</article>

        </main>

        <footer>
            Site generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
