<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Software ninja - Sharkd introduction (wireshark daemon)</title>
        <link rel="stylesheet" href="../css/default.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Ninja hacking</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Sharkd introduction (wireshark daemon)</h1>
            <article>
    <section class="header">
    Posted on December  2, 2021
    
        by Matt
    
    </section>
    <section>
    
    Tags: <a title="All pages tagged 'wireshark'." href="../tags/wireshark.html">wireshark</a>
    
    </section>
    <section>
<p><a href="www.wireshark.org">Wireshark</a> is the most famous packet capture/analysis software out there. Most of the times you use it interactively but there is a lesser known feature to instrument wireshark somewhat (it is limited): <strong>sharkd</strong>, the wireshark daemon.</p>
<p>You can setup the daemon to listen on a unix socket:</p>
<pre><code>sharkd unix:/tmp/sharkd</code></pre>
<p>and send json requests to that socket.</p>
<p>The protocol used in sharkd was changed in wireshark 3.6 and as of this writing, the [official documentation][sharkd-doc] has not been updated so refer to the source (anything with sharkd in the name). A bunch of 3.6 compatible requests are available in <a href="https://github.com/teto/mptcpanalyzer/tree/main/contrib">mptcpanalyzer’s contrib folder</a>.</p>
<p>You can run them via</p>
<pre><code>cat analyze.json | socat UNIX-CONNECT:/tmp/sharkd.sock -</code></pre>
<p>Note that in practice there are several pitfalls to avoid: - the order of attributes in the json matters ! “method” has to come before “params” see <a href="https://ask.wireshark.org/question/25581/invalid-json-request-to-tshark/">this post</a> for details. - the requests have to be written on one line and finish with a newline to be processed.</p>
    </section>
</article>

        </main>

        <footer>
            Site generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
